<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Omada Login Test</title>
</head>
<body>
    <h1>Omada Login Test</h1>
    <button id="loginButton">Login</button>
    <div id="response"></div>

    <script>
        async function performLogin() {
            const OMADA_URL = "https://192.168.0.50:443";
            const USERNAME = "obordoreynel@gmail.com";
            const PASSWORD = "Gofuckyourself123***";
            const CLIENT_ID = "e9268e9afe6e49fb83a2140a14834a66";
            const OMADA_ID = "2b620cc1a125dfb76ddbad7be8299745";

            try {
                // Login and obtain CSRF token and session ID
                let response = await fetch(`${OMADA_URL}/openapi/authorize/login?client_id=${CLIENT_ID}&omadac_id=${OMADA_ID}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        username: USERNAME,
                        password: PASSWORD
                    })
                });

                let data = await response.json();

                // Display the login response
                document.getElementById('response').innerText = JSON.stringify(data, null, 2);

                if (data.result) {
                    const CSRFTOKEN = data.result.csrfToken;
                    const SESSIONID = data.result.sessionId;

                    console.log(`Login successful! CSRF Token: ${CSRFTOKEN}, Session ID: ${SESSIONID}`);
                } else {
                    console.error('Login failed:', data);
                }

            } catch (error) {
                console.error('Failed to login:', error);
                document.getElementById('response').innerText = 'Failed to login: ' + error.message;
            }
        }

        document.getElementById('loginButton').addEventListener('click', function () {
            performLogin();
        });
    </script>
</body>
</html>
